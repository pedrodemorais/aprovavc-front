<div class="conteudo">
<form *ngIf="equipForm" [formGroup]="equipForm" class="equip-form">

  <!-- CLIENTE -->
  <section class="card">
    <h2>Cliente</h2>

    <div class="linha">
      <div class="field half">
<label for="cliente">Cliente *</label>
<p-autoComplete
  inputId="cliente"
  formControlName="cliente"
  [suggestions]="clienteSugestoes"
  (completeMethod)="filtrarClientes($any($event))"
  field="nome"
  [forceSelection]="true"
  placeholder="Busque por nome, CPF/CNPJ ou telefone"
  [style]="{ width: '100%' }"
  [inputStyle]="{ width: '100%' }">
</p-autoComplete>

<small class="erro" *ngIf="isInvalid('cliente')">Selecione um cliente.</small>

      </div>

      <div class="field third">
        <label for="contato">Contato</label>
        <input id="contato" pInputText formControlName="contato" placeholder="Telefone ou e-mail" />
      </div>

      <div class="field third">
        <label for="documento">Documento (CPF/CNPJ)</label>
        <input id="documento" pInputText formControlName="documento" />
      </div>
    </div>
  </section>

  <!-- IDENTIFICAÇÃO DO EQUIPAMENTO -->
  <section class="card">
    <h2>Equipamento</h2>

    <div class="linha">
      <div class="field third">
        <label for="tipo">Tipo *</label>
        <p-dropdown id="tipo" formControlName="tipo"
                    [options]="tiposEquip"
                    optionLabel="label" optionValue="value"
                    placeholder="Selecione"></p-dropdown>
        <small class="erro" *ngIf="isInvalid('tipo')">Selecione o tipo.</small>
      </div>

      <div class="field third">
        <label for="marca">Marca</label>
        <input id="marca" pInputText formControlName="marca" placeholder="Ex: Apple, Samsung, LG" />
      </div>

      <div class="field third">
        <label for="modelo">Modelo</label>
        <input id="modelo" pInputText formControlName="modelo" placeholder="Ex: iPhone 12, AS09, RT38" />
      </div>
    </div>

    <div class="linha">
      <div class="field third">
        <label for="numeroSerie">Nº de Série / IMEI</label>
        <input id="numeroSerie" pInputText formControlName="numeroSerie" />
      </div>

      <div class="field third">
        <label for="cor">Cor</label>
        <input id="cor" pInputText formControlName="cor" />
      </div>

      <div class="field third">
        <label for="ano">Ano</label>
        <input id="ano" type="number" pInputText formControlName="ano" min="1900" max="2100" />
      </div>
    </div>

    <div class="linha">
      <div class="field third">
        <label for="tensao">Tensão (V)</label>
        <p-dropdown id="tensao" formControlName="tensao"
                    [options]="tensoes" placeholder="Selecione"></p-dropdown>
      </div>

      <div class="field third" *ngIf="equipForm.get('tipo')?.value === 'AR_CONDICIONADO'">
        <label for="btus">Capacidade (BTU)</label>
        <input id="btus" type="number" pInputText formControlName="btus" min="0" />
      </div>

      <div class="field third">
        <label for="localizacao">Localização Física</label>
        <input id="localizacao" pInputText formControlName="localizacao" placeholder="Ex: Prateleira B2" />
      </div>
    </div>
  </section>

  <!-- CHECK-IN / CONDIÇÕES -->
  <section class="card">
    <h2>Check-in & Condições</h2>

    <div class="linha">
      <div class="field third">
        <label for="estadoFisico">Estado Físico</label>
        <p-dropdown id="estadoFisico" formControlName="estadoFisico" [options]="estadosFisicos"></p-dropdown>
      </div>

      <div class="field third">
        <label for="liga">Liga?</label>
        <p-dropdown id="liga" formControlName="liga" [options]="opcoesSimNao"></p-dropdown>
      </div>

      <div class="field third">
        <label for="bloqueado">Bloqueado?</label>
        <p-dropdown id="bloqueado" formControlName="bloqueado" [options]="opcoesSimNao"></p-dropdown>
      </div>
    </div>

    <div class="linha" *ngIf="equipForm.get('bloqueado')?.value === true">
      <div class="field third">
        <label for="tipoBloqueio">Tipo de Bloqueio</label>
        <p-dropdown id="tipoBloqueio" formControlName="tipoBloqueio" [options]="tiposBloqueio"></p-dropdown>
      </div>
      <div class="field half">
        <label for="senhaDesbloqueio">Senha/Padrão/PIN</label>
        <input id="senhaDesbloqueio" pInputText formControlName="senhaDesbloqueio" />
        <small class="erro" *ngIf="isInvalid('senhaDesbloqueio')">Informe a senha/padrão de acesso.</small>
      </div>
    </div>

    <div class="field">
      <label for="acessorios">Acessórios Recebidos</label>
      <p-multiSelect id="acessorios"
                     formControlName="acessorios"
                     [options]="acessoriosPadrao"
                     optionLabel="label" optionValue="value"
                     defaultLabel="Selecione"></p-multiSelect>
    </div>

    <div class="field">
      <label for="defeitoRelatado">Defeito Relatado *</label>
      <textarea id="defeitoRelatado" pInputTextarea rows="3" formControlName="defeitoRelatado"
                placeholder="Descreva o problema informado pelo cliente"></textarea>
      <small class="erro" *ngIf="isInvalid('defeitoRelatado')">Descreva o defeito relatado.</small>
    </div>

    <div class="field">
      <label for="observacoesCondicao">Observações de Condição</label>
      <textarea id="observacoesCondicao" pInputTextarea rows="3" formControlName="observacoesCondicao"
                placeholder="Riscos, amassados, oxidação, tela trincada, etc."></textarea>
    </div>
  </section>

  <!-- GARANTIA -->
  <section class="card">
    <h2>Garantia</h2>

    <div class="linha">
      <div class="field third">
        <label for="emGarantia">Em Garantia?</label>
        <p-dropdown id="emGarantia" formControlName="emGarantia" [options]="opcoesSimNao"></p-dropdown>
      </div>

      <div class="field third">
        <label for="dataCompra">Data de Compra</label>
        <input id="dataCompra" type="date" pInputText formControlName="dataCompra" />
      </div>

      <div class="field third">
        <label for="comprovanteGarantia">Comprovante (NFe/Doc)</label>
        <input id="comprovanteGarantia" type="file" accept=".pdf,.jpg,.jpeg,.png"
               (change)="onUploadGarantia($event)" />
      </div>
    </div>
  </section>

  <!-- CONSENTIMENTOS -->
  <section class="card">
    <h2>Consentimentos</h2>
    <div class="linha">
      <div class="field half">
        <p-checkbox binary="true" formControlName="autorizaBackup" inputId="autorizaBackup"></p-checkbox>
        <label for="autorizaBackup">Autoriza backup de dados, se necessário</label>
      </div>
      <div class="field half">
        <p-checkbox binary="true" formControlName="autorizaReset" inputId="autorizaReset"></p-checkbox>
        <label for="autorizaReset">Autoriza reset de fábrica, se necessário</label>
      </div>
    </div>

    <div class="linha">
      <div class="field half">
        <p-checkbox binary="true" formControlName="aceiteTermos" inputId="aceiteTermos"></p-checkbox>
        <label for="aceiteTermos">Li e aceito os termos de serviço *</label>
        <small class="erro" *ngIf="isInvalid('aceiteTermos')">É necessário aceitar os termos.</small>
      </div>
    </div>
  </section>

  <!-- ANEXOS -->
  <section class="card">
    <h2>Anexos</h2>
    <div class="linha">
      <div class="field half">
        <label for="fotos">Fotos do Equipamento (entrada)</label>
        <input id="fotos" type="file" accept="image/*" multiple (change)="onUploadFotos($event)" />
      </div>
      <div class="field half">
        <label for="docsAdicionais">Documentos Adicionais</label>
        <input id="docsAdicionais" type="file" accept=".pdf,.jpg,.jpeg,.png" multiple (change)="onUploadDocs($event)" />
      </div>
    </div>
  </section>

  <!-- AÇÕES -->
  
</form>
</div>